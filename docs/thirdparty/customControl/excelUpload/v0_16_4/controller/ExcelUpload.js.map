{"version":3,"file":"ExcelUpload.js","names":["sap","ui","define","Fragment","MessageToast","XLSX","__MetadataHandler","___types","__ODataV2","__ODataV4","__Util","__Parser","__ErrorHandler","__Preview","Log","JSONModel","__Options","_interopRequireDefault","obj","__esModule","default","MetadataHandler","ErrorTypes","ODataV2","ODataV4","Util","Parser","ErrorHandler","Preview","Options","ExcelUpload","constructor","component","componentI18n","this","dialog","errorState","UI5MinorVersion","version","split","util","getResourceBundle","isODataV4","_checkIfODataIsV4","isOpenUI5","generic","odataHandler","getODataHandler","initialSetupPromise","initialSetup","previewHandler","async","optionsHandler","infoModel","dataRows","strict","getStrict","load","name","type","controller","setModel","getModel","getStandalone","getColumns","length","getSubHeader","setVisible","getContentLeft","errorHandler","metadataHandler","metaDatahandler","setContext","error","errorMessage","context","getContext","base","view","getView","tableObject","getTableObject","getTableId","setTableId","getId","binding","getBinding","Error","geti18nText","odataType","getOdataType","setOdataType","odataKeyList","getKeyList","typeLabelList","createLabelList","model","DraftController","_loadDraftController","draftController","undefined","getContent","getItems","clear","open","showError","showPreview","payloadArray","event","setErrorResults","file","getParameter","workbook","_readWorkbook","sheetName","SheetNames","excelSheetsData","utils","sheet_to_row_object_array","Sheets","columnNames","sheet_to_json","header","object","key","trim","checkMandatoryColumns","getMandatoryFields","checkColumnNames","getFieldMatchType","payload","fireCheckBeforeRead","sheetData","parseExcelData","areErrorsPresent","displayErrors","setDataRows","resetContent","onCloseDialog","close","onOpenOptionsDialog","openOptionsDialog","isDefaultNotPrevented","fireUploadButtonPress","show","that","source","getSource","sourceParent","getParent","setBusyIndicatorDelay","setBusy","sleep","fnAddMessage","Promise","fnResolve","fnReject","callOdata","mParameters","busy","set","check","dataloss","popup","navigation","sActionLabel","editFlow","securedExecution","extensionAPI","slicedPayloadArray","processPayloadArray","getBatchSize","batch","fireChangeBeforeCreate","createAsync","waitForCreation","getActivateDraft","waitForDraft","resetContexts","refresh","onTempDownload","fieldMatchType","excelColumnList","column","value","Object","entries","label","ws","json_to_sheet","wb","book_new","book_append_sheet","writeFile","getExcelFileName","getODataVersion","_setPayload","stream","buffers","reader","getReader","res","read","push","done","out","Uint8Array","reduce","acc","v","off","u8","resolve","reject","data","buffer_RS","require","err","setProperty","fileUploader","setValue","getErrorResults","addToErrorsResults","errorArray","forEach","group","CustomErrorGroup","CustomError","counter"],"sources":["ExcelUpload-dbg.js"],"mappings":"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"}